# æ•°æ™ºé£æ§ï¼šé¢å‘æ–°äº§å“çš„ä¿¡ç”¨é£é™©è¯„ä¼°

æ•°æ®ç§‘å­¦ç«èµ›é¡¹ç›® - åŸºäºå°æ ·æœ¬æ•°æ®çš„ä¿¡è´·è¿çº¦é£é™©é¢„æµ‹

---

## ğŸ“‹ èµ›é¢˜æ¦‚è¿°

### èƒŒæ™¯

å½“å‰é‡‘èäº§å“å¿«é€Ÿè¿­ä»£ï¼Œæ–°äº§å“ä¸Šçº¿åˆæœŸå¾€å¾€å…·æœ‰ï¼š
- è¿˜æ¬¾è¡¨ç°æœŸçŸ­
- é£é™©æš´éœ²ä¸å……åˆ†
- å¯ç”¨å»ºæ¨¡æ ·æœ¬å°‘
- è¿çº¦æ ·æœ¬æå°‘

æœ¬ç«èµ›æ¢ç´¢"çŸ¥è¯†+æ•°æ®"åŒé©±åŠ¨çš„æ•°æ™ºé£æ§è§£å†³æ–¹æ¡ˆï¼Œæ¨åŠ¨æ•°æ®ç§‘å­¦ã€äººå·¥æ™ºèƒ½ã€ä¸šåŠ¡éœ€æ±‚çš„æ·±åº¦èåˆã€‚

### ä»»åŠ¡ç›®æ ‡

åŸºäºä¿¡è´·é£æ§è„±æ•æ•°æ®é›†ï¼Œæ„å»ºè¿çº¦é£é™©é¢„æµ‹æ¨¡å‹ï¼Œé¢„æµ‹å®¢æˆ·æ˜¯å¦ä¼šè¿çº¦ã€‚

**æ ¸å¿ƒæŒ‘æˆ˜**:
- è®­ç»ƒé›†ä»…500æ¡ï¼Œè¿çº¦æ ·æœ¬çº¦10æ¡ï¼ˆ2%è¿çº¦ç‡ï¼‰
- è®­ç»ƒé›†ä¸æµ‹è¯•é›†å¯èƒ½å­˜åœ¨è¾ƒå¤§åˆ†å¸ƒåå·®
- éœ€è¦å……åˆ†ç†è§£ä¸šåŠ¡çŸ¥è¯†ï¼Œè¿ç”¨AIæŠ€æœ¯è¿›è¡Œç‰¹å¾å¢å¼ºã€æ ·æœ¬é‡æ„

---

## ğŸ“Š æ•°æ®è¯´æ˜

### æ•°æ®è§„æ¨¡

- **è®­ç»ƒé›†**: 500æ¡
- **æµ‹è¯•é›†**: 4500æ¡ï¼ˆå…¬æ¦œ1000æ¡ + ç§æ¦œ1000æ¡ + å¹²æ‰°2500æ¡ï¼‰
- **ç‰¹å¾ç»´åº¦**: 23ä¸ªå­—æ®µï¼ˆå«æ ‡ç­¾ï¼‰
- **æ ‡ç­¾**: targetï¼ˆ1=è¿çº¦ï¼Œ0=æ­£å¸¸è¿˜æ¬¾ï¼‰

### ç‰¹å¾ç±»å‹

| ç±»åˆ« | ç‰¹å¾ç¤ºä¾‹ |
|------|----------|
| è´·æ¬¾åŸºæœ¬ä¿¡æ¯ | ç”³è¯·é‡‘é¢ã€è´·æ¬¾ç”¨é€” |
| å€Ÿæ¬¾äººç‰¹å¾ | æœˆæ”¶å…¥ã€å·¥é¾„ã€æˆ¿å±‹æ‰€æœ‰æƒ |
| å†å²ä¿¡ç”¨è¡Œä¸º | é€¾æœŸæ¬¡æ•°ã€è¿çº¦æ¬¡æ•°ã€å¾ä¿¡æŸ¥è¯¢æ¬¡æ•° |
| è´Ÿå€ºä¸è´¦æˆ· | ä¿¡ç”¨å¡æ•°é‡ã€å·²ç”¨é¢åº¦ã€æ€»æˆä¿¡é¢åº¦ã€å¤šå¤´å€Ÿè´· |
| è¿‘æœŸä¿¡ç”¨åŠ¨æ€ | æœ€è¿‘ä¿¡ç”¨å¡å¼€æˆ·æœˆæ•°ã€æœ€è¿‘å€Ÿæ¬¾æœˆæ•° |

---

## ğŸ¯ é¡¹ç›®ç»“æ„

```
DataScienceContest/
â”‚
â”œâ”€â”€ baseline/                          # åŸºå‡†æ¨¡å‹æ–¹æ³•
â”‚   â”œâ”€â”€ data_preprocessing.py         # æ•°æ®é¢„å¤„ç†
â”‚   â”œâ”€â”€ machine_learning_models.py    # åŸºç¡€MLæ¨¡å‹
â”‚   â”œâ”€â”€ stacking_models.py            # Stackingé›†æˆ
â”‚   â”œâ”€â”€ credit_risk_main.py           # ä¸»ç¨‹åº
â”‚   â”œâ”€â”€ run_stacking.py               # Stackingè®­ç»ƒ
â”‚   â”œâ”€â”€ plot_predictions.py           # å¯è§†åŒ–åˆ†æ
â”‚   â”œâ”€â”€ requirements.txt              # ä¾èµ–åŒ…
â”‚   â””â”€â”€ outputs/                      # è¾“å‡ºç»“æœ
â”‚
â”œâ”€â”€ GANmodel/                          # GANæ•°æ®å¢å¼ºæ–¹æ³•
â”‚   â”œâ”€â”€ train_gan.py                  # GANè®­ç»ƒ
â”‚   â”œâ”€â”€ generate_synthetic_data.py    # åˆæˆæ•°æ®ç”Ÿæˆ
â”‚   â”œâ”€â”€ evaluate_synthetic_data.py    # è´¨é‡è¯„ä¼°
â”‚   â”œâ”€â”€ train_with_gan.py             # G-XGBoostè®­ç»ƒ
â”‚   â”œâ”€â”€ requirements.txt              # ä¾èµ–åŒ…
â”‚   â”œâ”€â”€ models/                       # GANæ¨¡å‹
â”‚   â”œâ”€â”€ synthetic_data/               # åˆæˆæ•°æ®
â”‚   â””â”€â”€ evaluation/                   # è¯„ä¼°ç»“æœ
â”‚
â”œâ”€â”€ åˆèµ›é€‰æ‰‹æ•°æ®/                      # æ¯”èµ›æ•°æ®
â”‚   â”œâ”€â”€ è®­ç»ƒæ•°æ®é›†.xlsx
â”‚   â”œâ”€â”€ æµ‹è¯•é›†.xlsx
â”‚   â””â”€â”€ æäº¤æ ·ä¾‹.csv
â”‚
â”œâ”€â”€ èµ›é¢˜ä¸æ•°æ®è¯´æ˜.md                  # èµ›é¢˜è¯¦ç»†è¯´æ˜
â””â”€â”€ README.md                          # æœ¬æ–‡ä»¶
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒå‡†å¤‡

```bash
# Python 3.8+
pip install pandas numpy scikit-learn matplotlib seaborn
pip install xgboost lightgbm openpyxl imbalanced-learn
```

### æ–¹æ³•1: Baselineæ–¹æ³•ï¼ˆæ¨èé¦–é€‰ï¼‰

```bash
cd baseline

# è¿è¡Œå®Œæ•´æµç¨‹
python credit_risk_main.py
# è¾“å‡º: outputs/ensemble_submission.csv

# æˆ–ä½¿ç”¨ä¼˜åŒ–çš„Stackingæ¨¡å‹
python run_stacking.py --strategy simple_average
# è¾“å‡º: outputs/stacking_top3_simple_avg_submission.csv

# å¯è§†åŒ–åˆ†æ
python plot_predictions.py
```

**é¢„æœŸå¾—åˆ†**: 0.56-0.58

### æ–¹æ³•2: GANæ•°æ®å¢å¼ºæ–¹æ³•ï¼ˆå®éªŒæ€§ï¼‰

```bash
cd GANmodel

# æ­¥éª¤1: è®­ç»ƒGANç”Ÿæˆè¿çº¦æ ·æœ¬
python train_gan.py --use-sdv --target-class minority --epochs 300

# æ­¥éª¤2: ç”Ÿæˆåˆæˆæ•°æ®
python generate_synthetic_data.py \
    --use-sdv \
    --target-class minority \
    --num-samples 500

# æ­¥éª¤3: è¯„ä¼°åˆæˆæ•°æ®è´¨é‡
python evaluate_synthetic_data.py \
    --real-data ../åˆèµ›é€‰æ‰‹æ•°æ®/è®­ç»ƒæ•°æ®é›†.xlsx \
    --synthetic-data synthetic_data/synthetic_minority.csv

# æ­¥éª¤4: ä½¿ç”¨å¢å¼ºæ•°æ®è®­ç»ƒæ¨¡å‹
python train_with_gan.py \
    --synthetic-data-path synthetic_data/synthetic_minority.csv \
    --augment-strategy minority \
    --model-type stacking
```

**é¢„æœŸå¾—åˆ†**: 0.57-0.59ï¼ˆç†è®ºï¼‰

---

## ğŸ“ˆ æŠ€æœ¯æ–¹æ¡ˆ

### Baselineæ–¹æ¡ˆ

#### 1. æ•°æ®é¢„å¤„ç†
- ç¼ºå¤±å€¼å¤„ç†ï¼ˆä¸­ä½æ•°/ä¼—æ•°å¡«å……ï¼‰
- ç‰¹å¾å·¥ç¨‹ï¼ˆè¡ç”Ÿç‰¹å¾ã€æ¯”ç‡ç‰¹å¾ï¼‰
- SMOTEæ ·æœ¬å¹³è¡¡ï¼ˆè§£å†³2%è¿çº¦ç‡é—®é¢˜ï¼‰
- ç‰¹å¾æ ‡å‡†åŒ–

#### 2. æ¨¡å‹é›†æˆ
**åŸºç¡€æ¨¡å‹**:
- Logistic Regression
- Random Forest
- Gradient Boosting
- XGBoost
- LightGBM
- KNN
- Decision Tree
- Naive Bayes

**é›†æˆç­–ç•¥**:
- Voting Ensembleï¼ˆç®€å•å¹³å‡/åŠ æƒå¹³å‡ï¼‰
- Stackingï¼ˆä¸¤å±‚æ¨¡å‹ï¼ŒRidgeå…ƒå­¦ä¹ å™¨ï¼‰

#### 3. æœ€ä½³é…ç½®
```bash
# Top3æ¨¡å‹ç®€å•å¹³å‡
python run_stacking.py --strategy simple_average --top-n 3
```

**Top3æ¨¡å‹**: XGBoost + Random Forest + Gradient Boosting

### GANæ•°æ®å¢å¼ºæ–¹æ¡ˆï¼ˆG-XGBoostï¼‰

åŸºäºè®ºæ–‡ã€ŠA Credit Risk Model with Small Sample Data Based on G-XGBoostã€‹

#### æ ¸å¿ƒæ€æƒ³
1. ä½¿ç”¨CTGANå­¦ä¹ çœŸå®æ•°æ®åˆ†å¸ƒ
2. ç”Ÿæˆé«˜è´¨é‡åˆæˆè¿çº¦æ ·æœ¬
3. æ‰©å……è®­ç»ƒé›†ï¼ˆ500 â†’ 1000+ï¼‰
4. ç¼“è§£æ ·æœ¬ä¸å¹³è¡¡å’Œè¿‡æ‹Ÿåˆ

#### å…³é”®æŠ€æœ¯
- **CTGAN**: ä¸“ä¸ºè¡¨æ ¼æ•°æ®è®¾è®¡çš„æ¡ä»¶GAN
- **æ•°æ®è´¨é‡è¯„ä¼°**: åˆ†å¸ƒå¯¹æ¯”ã€ç›¸å…³æ€§åˆ†æã€PCAå¯è§†åŒ–
- **å¢å¼ºç­–ç•¥**: åªå¢å¼ºå°‘æ•°ç±»ï¼ˆè¿çº¦æ ·æœ¬ï¼‰

#### ä¼˜åŠ¿
- è§£å†³å°æ ·æœ¬é—®é¢˜
- å¹³è¡¡æ­£è´Ÿæ ·æœ¬
- æå‡æ¨¡å‹æ³›åŒ–èƒ½åŠ›

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| æ–¹æ³• | é¢„æµ‹å‡å€¼ | CV AUC | å®é™…å¾—åˆ† | æ¨èåº¦ |
|------|----------|--------|----------|--------|
| **Ensemble (Baseline)** | 0.0565 | - | **0.5607** | â­â­â­ |
| Stacking Simple Avg | 0.0419 | ~0.999 | ? | â­â­â­ |
| Stacking Ridge | 0.0531 | ~0.999 | ? | â­â­ |
| G-XGBoost (GANå¢å¼º) | ? | ? | ? | â­â­â­ (å®éªŒæ€§) |
| Gradient Boosting | 0.0424 | 0.9984 | ? | â­â­ |
| Random Forest | 0.0670 | 0.9990 | ? | â­â­ |
| XGBoost | 0.0163 | 0.9989 | ? | â­ |

---

## ğŸ” å…³é”®å‘ç°

### 1. è¿‡æ‹Ÿåˆé—®é¢˜ä¸¥é‡
- è®­ç»ƒé›†AUCæ¥è¿‘1.0
- é¢„æµ‹è¿‡äºä¿å®ˆï¼ˆå‡å€¼è¿‡ä½ï¼‰æˆ–æ¿€è¿›ï¼ˆå‡å€¼è¿‡é«˜ï¼‰éƒ½ä¸åˆ©
- **æœ€ä½³é¢„æµ‹å‡å€¼**: 0.05-0.06ï¼ˆæ¥è¿‘Ensembleï¼‰

### 2. é›†æˆä¼˜äºå•æ¨¡å‹
- ç®€å•å¹³å‡æ•ˆæœä¼˜äºå¤æ‚å…ƒå­¦ä¹ å™¨
- Top3æ¨¡å‹è¶³å¤Ÿï¼Œæ›´å¤šæ¨¡å‹ä¸ä¸€å®šæ›´å¥½
- é¿å…å…ƒæ¨¡å‹è¿‡æ‹Ÿåˆ

### 3. SMOTEæ ·æœ¬å¹³è¡¡å¿…è¦
- åŸå§‹2%è¿çº¦ç‡å¯¼è‡´æ¨¡å‹åå‘é¢„æµ‹0
- SMOTEæ‰©å……åˆ°20-30%è¿çº¦ç‡æ•ˆæœæœ€ä½³
- è¿‡åº¦å¹³è¡¡ï¼ˆ50%ï¼‰å¯èƒ½é€‚å¾—å…¶å

### 4. ç‰¹å¾å·¥ç¨‹ä»·å€¼æœ‰é™
- åŸå§‹ç‰¹å¾å·²è¾ƒå®Œå–„
- ç®€å•è¡ç”Ÿç‰¹å¾ï¼ˆæ¯”ç‡ã€äº¤äº’ï¼‰æœ‰å¸®åŠ©
- å¤æ‚ç‰¹å¾å¯èƒ½å¼•å…¥å™ªå£°

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- **baseline/README.md**: Baselineæ–¹æ³•å®Œæ•´æŒ‡å—
- **baseline/STACKING_README.md**: Stackingæ¨¡å‹è¯¦ç»†è¯´æ˜
- **GANmodel/README.md**: GANæ•°æ®å¢å¼ºå®Œæ•´æŒ‡å—
- **èµ›é¢˜ä¸æ•°æ®è¯´æ˜.md**: å®˜æ–¹èµ›é¢˜è¯´æ˜
- **baseline/outputs/**: å„ç§è®­ç»ƒæŠ¥å‘Šå’Œåˆ†æ

---

## ğŸ› ï¸ æ¨èä½¿ç”¨æµç¨‹

### åˆå­¦è€…æµç¨‹

```bash
# 1. è¿è¡ŒBaselineè·å–åŸºå‡†
cd baseline
python credit_risk_main.py

# 2. æŸ¥çœ‹ç»“æœ
ls outputs/*.csv
python plot_predictions.py

# 3. æäº¤æœ€ä½³ç»“æœ
# æäº¤ outputs/ensemble_submission.csv
```

### è¿›é˜¶æµç¨‹

```bash
# 1. å°è¯•ä¼˜åŒ–çš„Stacking
cd baseline
python run_stacking.py --test-all

# 2. å¯¹æ¯”æ‰€æœ‰æ¨¡å‹
python plot_predictions.py

# 3. å®éªŒGANå¢å¼º
cd ../GANmodel
python train_gan.py --use-sdv --target-class minority
python generate_synthetic_data.py --use-sdv --num-samples 500
python train_with_gan.py --augment-strategy minority --model-type stacking

# 4. é€‰æ‹©æœ€ä½³æ–¹æ¡ˆæäº¤
```

---

## âš™ï¸ é«˜çº§é…ç½®

### Stackingå‚æ•°è°ƒä¼˜

```bash
python run_stacking.py \
    --strategy simple_average \  # ç­–ç•¥: simple_average/ridge/xgboost
    --top-n 3 \                  # ä½¿ç”¨Top Nä¸ªæ¨¡å‹
    --n-folds 5 \                # KæŠ˜äº¤å‰éªŒè¯
    --C 0.1                      # æ­£åˆ™åŒ–å¼ºåº¦ï¼ˆä»…Ridgeï¼‰
```

### GANå‚æ•°è°ƒä¼˜

```bash
python train_gan.py \
    --use-sdv \                  # ä½¿ç”¨SDVåº“çš„CTGAN
    --target-class minority \    # ç”Ÿæˆç±»åˆ«: both/minority/majority
    --epochs 300 \               # è®­ç»ƒè½®æ•°
    --batch-size 500             # æ‰¹æ¬¡å¤§å°
```

---

## ğŸ¯ ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ–ï¼ˆå¯ç«‹å³å°è¯•ï¼‰
1. âœ… è°ƒæ•´SMOTEæ¯”ä¾‹ï¼ˆå°è¯•10%, 20%, 30%ï¼‰
2. âœ… æµ‹è¯•ä¸åŒTop-Nç»„åˆï¼ˆTop2, Top3, Top4ï¼‰
3. âœ… è°ƒæ•´æ­£åˆ™åŒ–å¼ºåº¦ï¼ˆC=0.01, 0.1, 1.0ï¼‰
4. âœ… å°è¯•ä¸åŒé›†æˆæƒé‡

### ä¸­æœŸä¼˜åŒ–ï¼ˆéœ€è¦å®éªŒï¼‰
1. ğŸ”„ GANæ•°æ®å¢å¼ºï¼ˆå·²å®ç°ï¼Œå¾…éªŒè¯ï¼‰
2. ğŸ”„ æ›´å¤šç‰¹å¾å·¥ç¨‹
3. ğŸ”„ æ¨¡å‹å‚æ•°ç²¾è°ƒ
4. ğŸ”„ æ¦‚ç‡æ ¡å‡†æŠ€æœ¯

### é•¿æœŸä¼˜åŒ–ï¼ˆé«˜çº§æŠ€æœ¯ï¼‰
1. â³ æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆTabNet, AutoIntï¼‰
2. â³ AutoMLè‡ªåŠ¨è°ƒå‚
3. â³ åŠç›‘ç£å­¦ä¹ åˆ©ç”¨æµ‹è¯•é›†
4. â³ é¢†åŸŸçŸ¥è¯†èå…¥ï¼ˆä¸“å®¶è§„åˆ™ï¼‰

---

## ğŸ¤” å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆè®­ç»ƒAUC=1.0ä½†å¾—åˆ†ä¸é«˜ï¼Ÿ
**A**: ä¸¥é‡è¿‡æ‹Ÿåˆã€‚å…³æ³¨äº¤å‰éªŒè¯AUCå’Œé¢„æµ‹åˆ†å¸ƒï¼Œè€Œéè®­ç»ƒæŒ‡æ ‡ã€‚

### Q2: åº”è¯¥ä½¿ç”¨å“ªä¸ªæ¨¡å‹æäº¤ï¼Ÿ
**A**: æ¨è `ensemble_submission.csv` æˆ– `stacking_top3_simple_avg_submission.csv`

### Q3: GANå¢å¼ºçœŸçš„æœ‰ç”¨å—ï¼Ÿ
**A**: ç†è®ºä¸Šæœ‰ç”¨ï¼Œä½†éœ€è¦å®éªŒéªŒè¯ã€‚è®ºæ–‡æŠ¥å‘Šæœ‰2-3%æå‡ã€‚

### Q4: å¦‚ä½•é¿å…è¿‡æ‹Ÿåˆï¼Ÿ
**A**:
- ä½¿ç”¨ç®€å•æ¨¡å‹/é›†æˆç­–ç•¥
- æ·»åŠ æ­£åˆ™åŒ–
- å…³æ³¨é¢„æµ‹åˆ†å¸ƒ
- KæŠ˜äº¤å‰éªŒè¯

### Q5: é¢„æµ‹åˆ†å¸ƒå¼‚å¸¸æ€ä¹ˆåŠï¼Ÿ
**A**:
- æ£€æŸ¥é¢„æµ‹å‡å€¼ï¼ˆåº”è¯¥0.05-0.06ï¼‰
- è°ƒæ•´SMOTEæ¯”ä¾‹
- é™ä½æ¨¡å‹å¤æ‚åº¦
- å¢åŠ æ­£åˆ™åŒ–

---

## ğŸ“– å‚è€ƒèµ„æ–™

### è®ºæ–‡
- Xu et al. (2019) - CTGAN: Conditional Tabular GAN
- Goodfellow et al. (2014) - Generative Adversarial Networks
- ã€ŠA Credit Risk Model with Small Sample Data Based on G-XGBoostã€‹

### å·¥å…·åº“
- [scikit-learn](https://scikit-learn.org/)
- [XGBoost](https://xgboost.readthedocs.io/)
- [imbalanced-learn](https://imbalanced-learn.org/)
- [SDV - Synthetic Data Vault](https://github.com/sdv-dev/SDV)

---

## ğŸ”„ æ›´æ–°æ—¥å¿—

### v2.0 (2025-10-18)
- âœ… å®Œæ•´çš„GANæ•°æ®å¢å¼ºæ¨¡å—
- âœ… ä¼˜åŒ–çš„Stackingé›†æˆç­–ç•¥
- âœ… å®Œå–„çš„å¯è§†åŒ–åˆ†æ
- âœ… è¯¦ç»†çš„æ–‡æ¡£å’Œä½¿ç”¨æŒ‡å—

### v1.0 (2025-10-17)
- âœ… Baselineå®ç°
- âœ… å¤šæ¨¡å‹é›†æˆ
- âœ… åŸºç¡€é¢„å¤„ç†æµç¨‹

---

## ğŸ“§ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹å„å­ç›®å½•çš„è¯¦ç»†æ–‡æ¡£æˆ–æå‡ºIssueã€‚

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ç”¨äºæ•°æ®ç§‘å­¦ç«èµ›å­¦ä¹ äº¤æµï¼Œæ•°æ®å·²è„±æ•å¤„ç†ï¼Œä¸æ¶‰åŠå®¢æˆ·éšç§ã€‚

---

**ç¥æ¯”èµ›é¡ºåˆ©ï¼** ğŸ¯
